name: "Star Wars: Pit Droids"
game_slug: star-wars-pit-droids
version: CD
slug: star-wars-pit-droids-cd
runner: wine

script:
  game:
    exe: $GAMEDIR/drive_c/Droids/Pit Droids.exe
    prefix: $GAMEDIR
  files:
    - 32bit_installer: https://github.com/idontnow/installers-4-lutris/raw/refs/heads/main/generic_32bit_installer/Setup.exe
  installer:
  - task:
      description: Creating Wine prefix
      name: create_prefix
      prefix: $GAMEDIR
  - task:
      app: quicktime72
      description: Installing QuickTime 7.2
      name: winetricks
      prefix: $GAMEDIR
  - insert-disc:
      requires: Launch.exe
  - copy:
      description: Copying CD files to cache
      dst: $CACHE
      src: $DISC
  - move:
      description: Trashing old 16-bit installer
      dst: $CACHE/trash/
      src: $CACHE/Lucas Learning Folder/Pit Droids/SETUP.EXE
  - move:
      description: Injecting new 32-bit installer
      dst: $CACHE/Lucas Learning Folder/Pit Droids/
      src: 32bit_installer
  - execute:
      command: printf "[InstallShield Silent]\nVersion=v5.00.000\nFile=Response File\n[DlgOrder]\nDlg0=SdWelcome-0\nCount=12\nDlg1=SdLicense-0\nDlg2=SdAskDestPath-0\nDlg3=SdSetupTypeEx-0\nDlg4=SdSelectFolder-0\nDlg5=SdStartCopy-0\nDlg6=MessageBox-0\nDlg7=AskOptions-0\nDlg8=MessageBox-1\nDlg9=AskOptions-1\nDlg10=AskYesNo-0\nDlg11=MessageBox-2\n[SdWelcome-0]\nResult=1\n[SdLicense-0]\nResult=1\n[SdAskDestPath-0]\nszDir=C:\Droids\nResult=1\n[SdSetupTypeEx-0]\nResult=Typical\n[SdSelectFolder-0]\nszFolder=Lucas Learning\nResult=1\n[SdStartCopy-0]\nResult=1\n[Application]\nName=Star Wars Pit Droids\nVersion=1.0\nCompany=Lucas Learning\n[MessageBox-0]\nResult=1\n[AskOptions-0]\nResult=1\nSel-0=1\n[MessageBox-1]\nResult=1\n[AskOptions-1]\nResult=1\nSel-0=0\n[AskYesNo-0]\nResult=0\n[MessageBox-2]\nResult=1" > "$GAMEDIR/drive_c/install.iss"
      description: Generating silent install response file ...
  - task:
      args: /s /f1c:/install.iss
      description: Silent-installing Star Wars Pit Droids to C:/Droids... Click Ok to close the QuickTime 4 setup!
      executable: $CACHE/Lucas Learning Folder/Pit Droids/Setup.exe
      name: wineexec
      prefix: $GAMEDIR
  - copy:
      description: Copying CD data to C drive (1/3)
      dst: $GAMEDIR/drive_c/CD/Data/FDat/
      src: $CACHE/Lucas Learning Folder/Pit Droids/Data/FDat/
  - copy:
      description: Copying CD data to C drive (2/3)
      dst: $GAMEDIR/drive_c/CD/Puzzles/
      src: $CACHE/Lucas Learning Folder/Pit Droids/Puzzles/
  - copy:
      description: Copying CD data to C drive (3/3)
      dst: $GAMEDIR/drive_c/CD/My Puzzles/
      src: $CACHE/Lucas Learning Folder/Pit Droids/My Puzzles/
  - task:
      key: SourcePath
      name: set_regedit
      path: HKEY_LOCAL_MACHINE\Software\Wow6432Node\Lucas Learning\Star Wars Pit Droids\1.0
      prefix: $GAMEDIR
      type: REG_SZ
      value: C:\\CD\\

